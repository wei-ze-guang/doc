# çŠ¶æ€æ¨¡å¼çš„å®šä¹‰
çŠ¶æ€æ¨¡å¼å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ”¹å˜å…¶è¡Œä¸ºã€‚çœ‹èµ·æ¥åƒæ˜¯å¯¹è±¡æ”¹å˜äº†ç±»ã€‚  
å½“å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒä¼šè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºï¼Œè€Œè¿™äº›è¡Œä¸ºæ˜¯æ ¹æ®å½“å‰çš„çŠ¶æ€æ¥å†³å®šçš„ã€‚çŠ¶æ€æ¨¡å¼é€šè¿‡å°†ä¸åŒçš„è¡Œä¸ºå°è£… 
åˆ°ä¸åŒçš„çŠ¶æ€å¯¹è±¡ä¸­ï¼Œä½¿å¾—è¿™äº›è¡Œä¸ºä¸å¯¹è±¡çš„çŠ¶æ€å…³è”ã€‚  
## 2. çŠ¶æ€æ¨¡å¼çš„ç»“æ„
- çŠ¶æ€æ¨¡å¼ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªè§’è‰²ï¼š
  - Contextï¼ˆç¯å¢ƒè§’è‰²ï¼‰ï¼šç»´æŠ¤ä¸€ä¸ª State ç±»å‹çš„å¼•ç”¨ï¼Œå®¢æˆ·ç«¯é€šè¿‡æ­¤å¯¹è±¡æ¥è§¦å‘çŠ¶æ€çš„è½¬ç§»ã€‚
  - Context å¯¹è±¡å¹¶ä¸ç›´æ¥å¤„ç†å…·ä½“çš„è¡Œä¸ºï¼Œè€Œæ˜¯å§”æ‰˜ç»™å½“å‰çš„ State å¯¹è±¡æ¥æ‰§è¡Œã€‚
- Stateï¼ˆæŠ½è±¡çŠ¶æ€è§’è‰²ï¼‰ï¼šå®šä¹‰æ‰€æœ‰å…·ä½“çŠ¶æ€ç±»éœ€è¦å®ç°çš„æ¥å£æˆ–æŠ½è±¡ç±»ã€‚
- ConcreteStateï¼ˆå…·ä½“çŠ¶æ€è§’è‰²ï¼‰ï¼šæ¯ä¸ªå…·ä½“çŠ¶æ€ç±»è´Ÿè´£å®ç°æŸä¸€å…·ä½“çŠ¶æ€ä¸‹çš„è¡Œä¸ºã€‚  
## çŠ¶æ€æ¨¡å¼çš„ç±»å›¾
```markdown
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   Context  â”‚
     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
     â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
     â”‚   State    â”‚
     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚
â–¼                 â–¼
ConcreteState1    ConcreteState2

```  
- Contextï¼šç¯å¢ƒè§’è‰²ï¼ŒæŒæœ‰å½“å‰çŠ¶æ€ï¼Œå¹¶é€šè¿‡çŠ¶æ€å¯¹è±¡æ¥å®Œæˆè¡Œä¸ºã€‚
- Stateï¼šçŠ¶æ€è§’è‰²ï¼Œå®šä¹‰æ¯ä¸ªçŠ¶æ€çš„è¡Œä¸ºã€‚
- ConcreteStateï¼šå…·ä½“çŠ¶æ€è§’è‰²ï¼Œå®ç°å…·ä½“çŠ¶æ€ä¸‹çš„è¡Œä¸ºã€‚  
## çŠ¶æ€æ¨¡å¼ä»£ç ç¤ºä¾‹ï¼šç”µæ¢¯æ§åˆ¶
æˆ‘ä»¬ä»¥ ç”µæ¢¯æ§åˆ¶ ä¸ºä¾‹æ¥è¯´æ˜çŠ¶æ€æ¨¡å¼ã€‚ç”µæ¢¯çš„å·¥ä½œæœ‰å¤šä¸ªçŠ¶æ€ï¼Œå¦‚ï¼šå¼€é—¨ã€å…³é—¨ã€ä¸Šä¸‹æ¥¼å±‚ ç­‰ã€‚  
- 1ï¸âƒ£ æŠ½è±¡çŠ¶æ€ï¼šLiftState  
```java
public abstract class LiftState {
    protected Lift lift;

    public LiftState(Lift lift) {
        this.lift = lift;
    }

    // å®šä¹‰ä¸åŒçŠ¶æ€çš„è¡Œä¸º
    public abstract void open();
    public abstract void close();
    public abstract void run();
    public abstract void stop();
}

```  
- 2ï¸âƒ£ å…·ä½“çŠ¶æ€ï¼šOpeningStateï¼ˆå¼€é—¨çŠ¶æ€ï¼‰  
```java
public class OpeningState extends LiftState {

    public OpeningState(Lift lift) {
        super(lift);
    }

    @Override
    public void open() {
        System.out.println("The lift door is already open.");
    }

    @Override
    public void close() {
        System.out.println("The lift door is closing.");
        lift.setLiftState(lift.getClosingState()); // åˆ‡æ¢åˆ°å…³é—¨çŠ¶æ€
    }

    @Override
    public void run() {
        System.out.println("The lift is opening the door. Cannot run now.");
    }

    @Override
    public void stop() {
        System.out.println("The lift is opening the door. Cannot stop now.");
    }
}

```  
- 3ï¸âƒ£ å…·ä½“çŠ¶æ€ï¼šClosingStateï¼ˆå…³é—¨çŠ¶æ€ï¼‰  
```java
public class ClosingState extends LiftState {

    public ClosingState(Lift lift) {
        super(lift);
    }

    @Override
    public void open() {
        System.out.println("The lift door is opening.");
        lift.setLiftState(lift.getOpeningState()); // åˆ‡æ¢åˆ°å¼€é—¨çŠ¶æ€
    }

    @Override
    public void close() {
        System.out.println("The lift door is already closed.");
    }

    @Override
    public void run() {
        System.out.println("The lift is now running.");
        lift.setLiftState(lift.getRunningState()); // åˆ‡æ¢åˆ°è¿è¡ŒçŠ¶æ€
    }

    @Override
    public void stop() {
        System.out.println("The lift is stopped.");
        lift.setLiftState(lift.getStoppedState()); // åˆ‡æ¢åˆ°åœæ­¢çŠ¶æ€
    }
}

```  
- 4ï¸âƒ£ å…·ä½“çŠ¶æ€ï¼šRunningStateï¼ˆè¿è¡ŒçŠ¶æ€ï¼‰  
```java
public class RunningState extends LiftState {

    public RunningState(Lift lift) {
        super(lift);
    }

    @Override
    public void open() {
        System.out.println("Cannot open the door while the lift is running.");
    }

    @Override
    public void close() {
        System.out.println("The lift door is already closed.");
    }

    @Override
    public void run() {
        System.out.println("The lift is already running.");
    }

    @Override
    public void stop() {
        System.out.println("The lift is stopping.");
        lift.setLiftState(lift.getStoppedState()); // åˆ‡æ¢åˆ°åœæ­¢çŠ¶æ€
    }
}

```  
- 5ï¸âƒ£ å…·ä½“çŠ¶æ€ï¼šStoppedStateï¼ˆåœæ­¢çŠ¶æ€ï¼‰  
```java
public class StoppedState extends LiftState {

    public StoppedState(Lift lift) {
        super(lift);
    }

    @Override
    public void open() {
        System.out.println("The lift door is opening.");
        lift.setLiftState(lift.getOpeningState()); // åˆ‡æ¢åˆ°å¼€é—¨çŠ¶æ€
    }

    @Override
    public void close() {
        System.out.println("The lift door is closing.");
        lift.setLiftState(lift.getClosingState()); // åˆ‡æ¢åˆ°å…³é—¨çŠ¶æ€
    }

    @Override
    public void run() {
        System.out.println("The lift is running now.");
        lift.setLiftState(lift.getRunningState()); // åˆ‡æ¢åˆ°è¿è¡ŒçŠ¶æ€
    }

    @Override
    public void stop() {
        System.out.println("The lift is already stopped.");
    }
}

```  
- 6ï¸âƒ£ ç¯å¢ƒç±»ï¼šLift  
```java
public class Lift {
    private LiftState openingState;
    private LiftState closingState;
    private LiftState runningState;
    private LiftState stoppedState;

    private LiftState currentState;

    public Lift() {
        openingState = new OpeningState(this);
        closingState = new ClosingState(this);
        runningState = new RunningState(this);
        stoppedState = new StoppedState(this);

        currentState = stoppedState; // åˆå§‹çŠ¶æ€ä¸ºåœæ­¢çŠ¶æ€
    }

    // åˆ‡æ¢çŠ¶æ€
    public void setLiftState(LiftState liftState) {
        this.currentState = liftState;
    }

    public LiftState getOpeningState() {
        return openingState;
    }

    public LiftState getClosingState() {
        return closingState;
    }

    public LiftState getRunningState() {
        return runningState;
    }

    public LiftState getStoppedState() {
        return stoppedState;
    }

    // å§”æ‰˜æ–¹æ³•ï¼Œè°ƒç”¨å½“å‰çŠ¶æ€çš„æ“ä½œ
    public void open() {
        currentState.open();
    }

    public void close() {
        currentState.close();
    }

    public void run() {
        currentState.run();
    }

    public void stop() {
        currentState.stop();
    }
}

```  
- 7ï¸âƒ£ å®¢æˆ·ç«¯
```java
public class Main {
    public static void main(String[] args) {
        Lift lift = new Lift();

        lift.open(); // æ‰“å¼€é—¨
        lift.close(); // å…³é—¨
        lift.run(); // å¯åŠ¨ç”µæ¢¯
        lift.stop(); // åœæ­¢ç”µæ¢¯
    }
}

```  
##  æ€»ç»“
ğŸ”‘ 5. æ€»ç»“
- âœ… ä¼˜ç‚¹ï¼š
  - å°è£…çŠ¶æ€è½¬æ¢çš„å¤æ‚æ€§ï¼šçŠ¶æ€æ¨¡å¼å°†ä¸çŠ¶æ€ç›¸å…³çš„è¡Œä¸ºæ”¾å…¥ä¸åŒçš„çŠ¶æ€ç±»ä¸­ï¼Œé¿å…äº†åœ¨ä»£ç ä¸­è¿›è¡Œå¤æ‚çš„æ¡ä»¶åˆ¤æ–­ã€‚
  - æ‰©å±•æ€§å¼ºï¼šæ·»åŠ æ–°çš„çŠ¶æ€éå¸¸ç®€å•ï¼Œåªéœ€æ–°å¢çŠ¶æ€ç±»å³å¯ã€‚
  - æ¸…æ™°çš„ç»“æ„ï¼šé€šè¿‡å°†æ¯ä¸ªçŠ¶æ€ä½œä¸ºç‹¬ç«‹çš„ç±»ï¼Œä»£ç æ›´åŠ æ¸…æ™°æ˜“æ‡‚ã€‚
- âŒ ç¼ºç‚¹ï¼š
  - ç±»çš„æ•°é‡å¢åŠ ï¼šæ¯å¢åŠ ä¸€ä¸ªçŠ¶æ€ï¼Œå°±éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»ï¼Œå¯èƒ½å¯¼è‡´ç±»çš„æ•°é‡æš´å¢ã€‚
  - çŠ¶æ€ç®¡ç†ï¼šå¦‚æœçŠ¶æ€ä¹‹é—´çš„è½¬æ¢é€»è¾‘è¿‡äºå¤æ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´çŠ¶æ€ç±»ä¹‹é—´çš„ç›¸äº’ä¾èµ–å’Œç®¡ç†å˜å¾—å›°éš¾ã€‚
- âœ… é€‚ç”¨åœºæ™¯ï¼š
  - å¤šä¸ªçŠ¶æ€çš„å¯¹è±¡ï¼šå¯¹è±¡çš„è¡Œä¸ºä¾èµ–äºå…¶å†…éƒ¨çŠ¶æ€ï¼Œå¹¶ä¸”è¿™äº›çŠ¶æ€ä¹‹é—´æœ‰æ˜ç¡®çš„è½¬æ¢å…³ç³»ã€‚
  - å¤æ‚çš„çŠ¶æ€æœºï¼šå¦‚GUIç»„ä»¶ã€æ¸¸æˆçŠ¶æ€ã€å·¥ä½œæµç³»ç»Ÿç­‰ã€‚